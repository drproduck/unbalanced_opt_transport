import numpy as np
import matplotlib.pyplot as plt


pairs = ((3, 5), (20562, 12428), (2564, 12380), (48485, 7605), (26428, 42698), (6152, 25061), (13168, 7506), (40816, 39370), (846, 16727), (31169, 7144))
opt_val_list = (
321.83947656441,
167.64555073518932,
207.3502556064093,
423.35617236431176,
117.52384257739209,
459.297428039594,
138.082535273433,
256.3855206718765,
221.13453306061183,
348.8398254732447
)

eps_list = np.linspace(5.0, 0.5, 10)
k_list_empirical_first = [
[5115, 5379, 5671, 6003, 6385, 6835, 8161, 11925, 20069, 47473],
[2492, 2523, 2643, 2807, 2827, 2875, 3193, 4471, 7233, 19543],
[3065, 3263, 3447, 3645, 3921, 4243, 5001, 7385, 12545, 29749],
[9444, 9756, 10104, 10498, 10904, 11422, 13548, 18894, 30202, 66692],
[1556, 1620, 1670, 1826, 2022, 2128, 2644, 3872, 6388, 16238],
[7932, 8232, 8568, 8944, 9372, 9818, 11656, 16694, 27414, 62414],
[3757, 3977, 4161, 4249, 4355, 4369, 4963, 7091, 12077, 28245],
[3040, 3284, 3552, 3772, 4114, 4430, 5264, 7862, 13586, 33018],
[4698, 4826, 5056, 5276, 5664, 6118, 7308, 10754, 18174, 42316],
[3709, 4013, 4357, 4755, 4937, 5209, 5825, 8375, 14703, 36407]
]

k_list_formula = [
[142777, 142777, 142777, 142777, 142777, 142777, 159406, 218722, 341155, 727020],
[104339, 104339, 104339, 104339, 104339, 104339, 113807, 156294, 244068, 521068],
[102530, 102530, 102530, 102530, 102530, 102530, 111691, 153396, 239559, 511494],
[184417, 184417, 184417, 184417, 184417, 184417, 209890, 287794, 448481, 954387],
[78698, 78698, 78698, 78698, 78698, 78698, 84098, 115591, 180706, 386455],
[168176, 168176, 168176, 168176, 168176, 168176, 190083, 260698, 406389, 865249],
[158268, 158268, 158268, 158268, 158268, 158268, 178071, 244264, 380852, 811150],
[124807, 124807, 124807, 124807, 124807, 124807, 137951, 189355, 295495, 630200],
[152680, 152680, 152680, 152680, 152680, 152680, 171321, 235027, 366498, 780735],
[144848, 144848, 144848, 144848, 144848, 144848, 161893, 222126, 346447, 738238]
]

k_list_empirical_first = np.array(k_list_empirical_first)
k_list_formula = np.array(k_list_formula)

k_list_empirical_first = np.log(k_list_empirical_first)
k_list_empirical_first = np.mean(k_list_empirical_first, axis=0)

k_list_formula = np.log(k_list_formula)
k_list_formula = np.mean(k_list_formula, axis=0)

plt.rcParams.update({'font.size': 22})
plt.figure(figsize=(10, 8))
# plt.plot(epsilon_list, [tmp / 1000 for tmp in k_list_empirical_true], "r", linewidth=4, label=r"$k_{true}$")
plt.plot(eps_list, [tmp for tmp in k_list_empirical_first], "g", linewidth=4, label=r"$k_{c}$")
plt.plot(eps_list, [tmp for tmp in k_list_formula], "b", linewidth=4, label=r"$k_{f}$")
plt.xlabel("epsilon")
plt.ylabel("log iteration")
plt.legend(prop={'size': 30})
plt.gca().invert_xaxis()

plt.savefig('k_comparison.eps', bbox_inches='tight')
plt.savefig('k_comparison.png', bbox_inches='tight')
plt.show()
